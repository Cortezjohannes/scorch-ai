import { generateContent } from './azure-openai';

// Horror Engine V2.0 - Comprehensive psychological terror and atmospheric dread framework

export interface HorrorEngineRecommendation {
  primaryRecommendation: {
    confidence: number;
    
    // Psychological Architecture - The Brain's Fear Engine
    psychologicalArchitecture: {
      neurobiologyOfTerror: {
        lowRoadPathway: any; // Fast amygdala hijack for jump scares
        highRoadPathway: any; // Slow cortical processing for atmospheric dread
        fearConditioning: any; // Learned associations and extinction resistance
        neurochemicalManipulation: any; // Adrenaline, cortisol, dopamine systems
      };
      evolutionaryFears: {
        primalTriggers: any; // Hardwired startle response and universal fears
        preparedFears: any; // Evolutionarily calibrated phobias (snakes, spiders, heights)
        developmentalFears: any; // Age-appropriate ancestral danger responses
        betterSafeSorryPrinciple: any; // Oversensitive threat detection system
      };
      existentialDread: {
        terrorManagementTheory: any; // Awareness of mortality and cultural worldviews
        denialOfDeath: any; // Cultural defenses against death anxiety
        symbolicImmortality: any; // Identifying with enduring larger meanings
        selfEsteemBuffer: any; // Personal anxiety buffer through cultural value
      };
      culturalMirror: {
        collectiveUnconscious: any; // Jungian archetypes and universal symbols
        socialBarometer: any; // Era-specific monsters reflecting societal anxieties
        definingOther: any; // Monster as categorical boundary enforcement
        reinforcingOrder: any; // Horror as cultural solidarity mechanism
      };
    };
    
    // Grammar of Atmosphere - Environmental Terror Construction
    grammarOfAtmosphere: {
      psychologyOfSpace: {
        isolationAgoraphobia: any; // Remote settings severing civilization safety
        claustrophobiaConfinement: any; // Trapped spaces limiting escape options
        uncannyHome: any; // Subverting domestic safety through architectural wrongness
        ecoHorror: any; // Nature as antagonist in three fear categories
      };
      architectureOfSound: {
        psychoacousticFear: any; // Infrasound, dissonance, pitch/timbre manipulation
        silenceNegativeSpace: any; // Strategic silence for tension and imagination
        diegeticVsNonDiegetic: any; // Story-world vs audience-only sound design
        foundFootageAuthenticity: any; // Raw audio for realistic immersion
      };
      chiaroscuroTerror: {
        lowKeyLighting: any; // High contrast shadows for mystery and concealment
        weaponizingShadows: any; // Negative space as active threat element
        harshUnnaturalLighting: any; // Distorting familiar features into monstrous
        darknessAsPresence: any; // Fear of unknown rather than absence of light
      };
      rhythmOfFear: {
        informationControl: any; // Suspense through uncertainty and foreshadowing
        rollercoasterModel: any; // Peaks and valleys of tension and relief
        timeAsWeapon: any; // Ticking clocks and temporal distortion
        scareEscalation: any; // Progressive intensity building to climax
      };
    };
    
    // Taxonomy of Terror - Subgenre-Specific Frameworks
    taxonomyOfTerror: {
      psychologicalHorror: {
        unreliableMind: any; // Narrator credibility and perception questioning
        gaslightingManipulation: any; // Systematic reality undermining
        ambiguityUncertainty: any; // Natural vs supernatural ambiguity
        subjectiveFramework: any; // Internal state reflection in audiovisual language
      };
      supernaturalHorror: {
        intangibleThreat: any; // Inexplicable forces beyond natural law
        folkloreIntegration: any; // Established mythology for credibility
        slowReveal: any; // Gradual presence building before entity manifestation
        atmosphericCraft: any; // Acousmatic sound and shadow-based presence
      };
      bodyHorror: {
        vulnerableFlesh: any; // Uncontrolled transformation and identity loss
        violationIntegrity: any; // Parasitism, contagion, mutilation imagery
        uncannyBody: any; // Familiar anatomy distorted into monstrous wrongness
        practicalEffects: any; // Tangible prosthetics for visceral impact
      };
      cosmicHorror: {
        indifferentUniverse: any; // Human insignificance in vast cosmos
        incomprehensibleThreats: any; // Unknowable alien entities beyond understanding
        forbiddenKnowledge: any; // Truth too terrible for human comprehension
        scaleAmbiguity: any; // Vastness emphasis with suggestion over revelation
      };
      slasherHorror: {
        mechanicsOfHunt: any; // Predation fear through systematic stalking
        formulaicStructure: any; // Rigid narrative patterns for tension/release
        finalGirlTrope: any; // Survival archetype and moral purity evolution
        isolationIngredients: any; // Cut-off settings and authority absence
      };
      folkHorror: {
        terrorOfTradition: any; // Ancient beliefs vs modern rationality clash
        isolatedCommunity: any; // Rural settings with hostile worldviews
        landscapeCharacter: any; // Environment imbued with malevolent history
        paganismFolkReligion: any; // Human belief systems as horror source
      };
    };
    
    // Visual Language - Cinematographic Terror
    visualLanguage: {
      predatorEye: {
        powerDynamicsAngles: any; // High/low angle shots for vulnerability/dominance
        cameraMovementPsychology: any; // Static paranoia vs tracking stalking
        perspectiveControl: any; // POV as psychological prosthesis
        dutchAngleDisorientation: any; // Tilted horizon for psychological imbalance
      };
      craftingNightmares: {
        practicalVsDigital: any; // SFX tangibility vs CGI impossibility
        psychologicalImpact: any; // Reality grounding vs uncanny valley risks
        actorPerformance: any; // Physical interaction vs post-production integration
        integratedApproach: any; // Hybrid techniques maximizing both strengths
      };
      colorOfFear: {
        paletteDesign: any; // Red violence, cool death, desaturated bleakness
        colorTheory: any; // Primal associations and emotional triggers
        subvertingSafeColors: any; // Cognitive dissonance through warm horror
        gradingManipulation: any; // Post-production mood enhancement
      };
    };
    
    // Future of Fear - Contemporary Innovation
    futureOfFear: {
      digitalGhost: {
        socialMediaTerror: any; // Networked anxiety and influencer horror themes
        livestreamTerror: any; // Real-time found footage evolution
        unreliablePlatform: any; // Technology corruption vs unreliable narrator
        parasocialNightmares: any; // One-sided intimacy turned sinister
      };
      horrorAsMetaphor: {
        monsterAsIdeology: any; // Physical embodiment of harmful social systems
        socialCommentary: any; // Real-world issue allegory framework
        groundedRealism: any; // Plausible horror for intellectual resonance
        collectiveAnxietyMining: any; // Contemporary fear identification and amplification
      };
      globalScream: {
        internationalTraditions: any; // J-Horror, New French Extremity, Southeast Asian
        culturalFearIntegration: any; // Respectful mythology and folklore incorporation
        aestheticDiversification: any; // Beyond Western horror conventions
        universalVsSpecificFears: any; // Global vs culturally particular anxieties
      };
      newCanvases: {
        streamingOptimization: any; // Binge-model pacing and technical delivery
        mobileVerticalFormats: any; // Bite-sized terror for mobile consumption
        interactiveImmersive: any; // VR, escape rooms, multi-sensory experiences
        branchingNarratives: any; // Participant agency in horror outcomes
      };
    };
  };
  
  horrorStrategy: {
    psychologicalApproach: string;
    atmosphericConstruction: string;
    subgenreSpecialization: string;
    visualExecution: string;
    contemporaryAdaptation: string;
  };
  
  implementationGuidance: {
    neurobiologicalTechniques: string[];
    atmosphericCraftMethods: string[];
    subgenreFrameworks: string[];
    cinematographicApproaches: string[];
    modernInnovations: string[];
  };
  
  terrorCraft: {
    fearEngineering: string;
    atmosphericMastery: string;
    subgenreExpertise: string;
    visualTerror: string;
    contemporaryRelevance: string;
  };
  
  frameworkBreakdown: {
    psychologicalMastery: number;
    atmosphericConstruction: number;
    subgenreVersatility: number;
    visualCraftsmanship: number;
    modernAdaptability: number;
  };
}

export interface HorrorBlueprint {
  id: string;
  name: string;
  
  // Core Framework
  horrorCore: {
    psychologicalApproach: string;
    atmosphericStyle: string;
    subgenreSpecialization: string;
    visualLanguage: string;
  };
  
  // Framework Implementation
  framework: {
    psychological: any;
    atmospheric: any;
    subgenre: any;
    visual: any;
    contemporary: any;
  };
  
  // Execution Strategy
  execution: {
    fearEngineering: any;
    atmosphere: any;
    scares: any;
    resolution: any;
  };
  
  // Quality Metrics
  metrics: {
    psychologicalImpact: number;
    atmosphericIntensity: number;
    subgenreAuthenticity: number;
    visualCraftsmanship: number;
  };
}

export class HorrorEngineV2 {
  static async generateHorrorEngineRecommendation(
    context: {
      projectTitle: string;
      horrorSubgenre: string;
      setting: string;
      targetAudience: string;
      narrativeScope: string;
      thematicElements: string[];
      terrorObjectives: string[];
      atmosphericGoals: string[];
    },
    requirements: {
      psychologicalApproach: string;
      atmosphericIntensity: string;
      scareStrategy: string;
      visualStyle: string;
      contemporaryRelevance: string;
      culturalSensitivity: string;
    },
    options: any = {}
  ): Promise<HorrorEngineRecommendation> {
    try {
      const prompt = `Generate comprehensive horror engine recommendation for ${context.horrorSubgenre} project.`;

      const response = await generateContent(prompt, {
        max_tokens: 3000,
        temperature: 0.7
      });

      return {
        primaryRecommendation: {
          confidence: 0.96,
          
          psychologicalArchitecture: {
            neurobiologyOfTerror: this.getNeurobiologyOfTerror(requirements.psychologicalApproach),
            evolutionaryFears: this.getEvolutionaryFears(context.thematicElements),
            existentialDread: this.getExistentialDread(context.terrorObjectives),
            culturalMirror: this.getCulturalMirror(context.thematicElements)
          },
          
          grammarOfAtmosphere: {
            psychologyOfSpace: this.getPsychologyOfSpace(context.setting),
            architectureOfSound: this.getArchitectureOfSound(requirements.atmosphericIntensity),
            chiaroscuroTerror: this.getChiaroscuroTerror(requirements.visualStyle),
            rhythmOfFear: this.getRhythmOfFear(context.narrativeScope)
          },
          
          taxonomyOfTerror: {
            psychologicalHorror: this.getPsychologicalHorror(context.horrorSubgenre),
            supernaturalHorror: this.getSupernaturalHorror(context.horrorSubgenre),
            bodyHorror: this.getBodyHorror(context.horrorSubgenre),
            cosmicHorror: this.getCosmicHorror(context.horrorSubgenre),
            slasherHorror: this.getSlasherHorror(context.horrorSubgenre),
            folkHorror: this.getFolkHorror(context.horrorSubgenre)
          },
          
          visualLanguage: {
            predatorEye: this.getPredatorEye(requirements.visualStyle),
            craftingNightmares: this.getCraftingNightmares(requirements.scareStrategy),
            colorOfFear: this.getColorOfFear(requirements.atmosphericIntensity)
          },
          
          futureOfFear: {
            digitalGhost: this.getDigitalGhost(requirements.contemporaryRelevance),
            horrorAsMetaphor: this.getHorrorAsMetaphor(context.thematicElements),
            globalScream: this.getGlobalScream(requirements.culturalSensitivity),
            newCanvases: this.getNewCanvases(context.narrativeScope)
          }
        },
        
        horrorStrategy: {
          psychologicalApproach: this.getPsychologicalApproach(requirements.psychologicalApproach),
          atmosphericConstruction: this.getAtmosphericConstruction(requirements.atmosphericIntensity),
          subgenreSpecialization: this.getSubgenreSpecialization(context.horrorSubgenre),
          visualExecution: this.getVisualExecution(requirements.visualStyle),
          contemporaryAdaptation: this.getContemporaryAdaptation(requirements.contemporaryRelevance)
        },
        
        implementationGuidance: {
          neurobiologicalTechniques: this.getNeurobiologicalTechniques(requirements.psychologicalApproach),
          atmosphericCraftMethods: this.getAtmosphericMethods(requirements.atmosphericIntensity),
          subgenreFrameworks: this.getSubgenreFrameworks(context.horrorSubgenre),
          cinematographicApproaches: this.getCinematographicApproaches(requirements.visualStyle),
          modernInnovations: this.getModernInnovations(requirements.contemporaryRelevance)
        },
        
        terrorCraft: {
          fearEngineering: `Master neurobiological terror through ${requirements.psychologicalApproach} approach`,
          atmosphericMastery: `Build ${requirements.atmosphericIntensity} atmospheric dread with precision`,
          subgenreExpertise: `Specialize in ${context.horrorSubgenre} conventions and innovations`,
          visualTerror: `Apply ${requirements.visualStyle} cinematographic language of fear`,
          contemporaryRelevance: `Adapt to ${requirements.contemporaryRelevance} modern horror landscape`
        },
        
        frameworkBreakdown: {
          psychologicalMastery: 0.96,
          atmosphericConstruction: 0.94,
          subgenreVersatility: 0.92,
          visualCraftsmanship: 0.90,
          modernAdaptability: 0.88
        }
      };
    } catch (error) {
      console.error('Error generating horror engine recommendation:', error);
      throw error;
    }
  }

  private static getNeurobiologyOfTerror(approach: string): any {
    const approaches: { [key: string]: any } = {
      'neurobiological': {
        lowRoad: 'Direct amygdala hijack for immediate physiological startle response',
        highRoad: 'Cortical processing for sustained atmospheric dread and cognitive tension',
        fearConditioning: 'Classical conditioning of neutral stimuli with aversive outcomes',
        neurochemical: 'Adrenaline spikes, cortisol elevation, dopamine reward cycles'
      },
      'evolutionary': {
        lowRoad: 'Hardwired startle exploiting survival reflexes',
        highRoad: 'Prepared fear pathways targeting ancestral threats',
        fearConditioning: 'Rapid acquisition of evolutionarily relevant dangers',
        neurochemical: 'Better safe than sorry principle driving oversensitive responses'
      }
    };
    return approaches[approach] || approaches['neurobiological'];
  }

  private static getEvolutionaryFears(themes: string[]): any {
    return {
      primalTriggers: 'Universal hardwired responses to sudden loud noises and looming objects',
      preparedFears: 'Genetic predisposition for snakes, spiders, heights, enclosed spaces, blood',
      developmentalFears: 'Age-appropriate vulnerability patterns: separation, heights, monsters, social rejection',
      betterSafeSorry: 'Evolved oversensitivity preferring false positives over fatal false negatives',
      thematicAlignment: `Targeting fears resonant with ${themes.join(', ')} themes`
    };
  }

  private static getExistentialDread(objectives: string[]): any {
    return {
      terrorManagement: 'Awareness of mortality creating potential for paralyzing existential terror',
      denialOfDeath: 'Cultural worldviews as elaborate defense mechanisms against annihilation anxiety',
      symbolicImmortality: 'Identification with enduring systems (religion, nation, legacy) for continuity',
      selfEsteemBuffer: 'Personal significance as defense against cosmic insignificance',
      objectiveIntegration: `Addressing ${objectives.join(', ')} through existential confrontation`
    };
  }

  private static getCulturalMirror(themes: string[]): any {
    return {
      collectiveUnconscious: 'Jungian archetypes: shadow, monster, hero manifesting in horror tropes',
      socialBarometer: 'Era-specific monsters reflecting contemporary collective anxieties',
      definingOther: 'Monstrous impurity challenging categorical boundaries (living/dead, human/animal)',
      reinforcingOrder: 'Horror defeat reinforcing dominant cultural values and group solidarity',
      culturalReflection: `Mirroring ${themes.join(', ')} societal concerns through monstrous embodiment`
    };
  }

  private static getPsychologyOfSpace(setting: string): any {
    const spaceTypes: { [key: string]: any } = {
      'isolated': {
        isolation: 'Remote settings severing civilization safety net',
        vulnerability: 'Amplified helplessness without rescue possibility',
        ostracismFear: 'Evolutionary terror of tribal expulsion',
        agoraphobia: 'Fear of inescapable situations'
      },
      'confined': {
        claustrophobia: 'Trapped spaces limiting movement and escape',
        physicalPressure: 'Palpable sense of restriction and confinement',
        sightlineLimitation: 'Reduced visual control and spatial mastery',
        breathingRoom: 'Psychological suffocation through environmental constraint'
      },
      'domestic': {
        uncannyHome: 'Familiar safety space made psychologically wrong',
        architecturalDissonance: 'Confusing layouts and nonsensical design',
        refugeViolation: 'Ultimate safety space corrupted into threat source',
        domesticInvasion: 'Private sphere penetrated by external malevolence'
      }
    };
    return spaceTypes[setting] || spaceTypes['isolated'];
  }

  private static getArchitectureOfSound(intensity: string): any {
    const intensityLevels: { [key: string]: any } = {
      'subtle': {
        infrasound: 'Sub-20Hz frequencies creating subliminal unease',
        ambientManipulation: 'Environmental sound distortion and uncanny acoustics',
        silenceWeaponization: 'Strategic audio absence for imagination activation',
        diegeticFocus: 'Story-world sounds emphasizing authenticity'
      },
      'moderate': {
        dissonance: 'Clashing musical intervals violating harmonic expectations',
        psychoacoustic: 'Pitch and timbre manipulation for emotional impact',
        negativeSpace: 'Silence as pregnant pause building anticipation',
        layeredDesign: 'Complex soundscapes blending diegetic and non-diegetic'
      },
      'intense': {
        acousticBlast: 'Sudden loud attacks for amygdala hijacking',
        frequencyAssault: 'High-pitched screeching mimicking scream patterns',
        overwhelmingSoundscape: 'Cacophonous audio chaos for disorientation',
        maximumContrast: 'Extreme silence-to-noise ratios for shock impact'
      }
    };
    return intensityLevels[intensity] || intensityLevels['moderate'];
  }

  private static getChiaroscuroTerror(style: string): any {
    const styles: { [key: string]: any } = {
      'classic': {
        lowKeyLighting: 'High contrast chiaroscuro with deep shadows',
        shadowWeaponization: 'Negative space as active threat element',
        mysteryAmbiguity: 'Concealment of potential dangers in darkness',
        traditionalTechniques: 'Film noir influenced lighting patterns'
      },
      'modern': {
        harshDirectional: 'Unnatural light angles distorting familiar features',
        practicalSources: 'Motivated lighting from flashlights, phones, bare bulbs',
        underlighting: 'Campfire effect making faces appear monstrous',
        digitalGrading: 'Post-production enhancement of contrast and mood'
      }
    };
    return styles[style] || styles['classic'];
  }

  private static getRhythmOfFear(scope: string): any {
    const scopes: { [key: string]: any } = {
      'feature': {
        informationControl: 'Strategic withholding and revelation of threat details',
        rollercoaster: 'Peaks and valleys of tension and relief cycles',
        scareEscalation: 'Progressive intensity building to climactic horror',
        timeWeaponization: 'Ticking clocks and temporal distortion for urgency'
      },
      'series': {
        episodicTension: 'Episode-ending cliffhangers maintaining engagement',
        seasonalArc: 'Long-form mystery and character development',
        bingeOptimization: 'Continuous viewing encouragement through pacing',
        serializedDread: 'Sustained atmospheric build across multiple episodes'
      }
    };
    return scopes[scope] || scopes['feature'];
  }

  private static getPsychologicalHorror(subgenre: string): any {
    if (subgenre.includes('psychological')) {
      return {
        unreliableNarrator: 'Questionable perception due to mental illness, trauma, or deception',
        gaslightingManipulation: 'Systematic reality undermining by malicious character',
        ambiguityUncertainty: 'Blurred lines between natural and supernatural explanations',
        subjectiveLanguage: 'Visual and auditory design reflecting internal psychological state'
      };
    }
    return 'Traditional horror without psychological focus';
  }

  private static getSupernaturalHorror(subgenre: string): any {
    if (subgenre.includes('supernatural')) {
      return {
        inexplicableThreat: 'Forces defying natural law and rational understanding',
        folkloreGrounding: 'Established mythology lending credibility and ancient power',
        slowRevealStrategy: 'Gradual entity presence building through subtle phenomena',
        atmosphericCraft: 'Acousmatic sound and shadow-based supernatural presence'
      };
    }
    return 'Traditional horror without supernatural elements';
  }

  private static getBodyHorror(subgenre: string): any {
    if (subgenre.includes('body')) {
      return {
        uncontrolledTransformation: 'Body mutating without consent, representing identity loss',
        violationIntegrity: 'Parasitism, contagion, mutilation imagery triggering disgust',
        uncannyBody: 'Familiar anatomy distorted into recognizable yet monstrous forms',
        practicalEffectsEmphasis: 'Tangible prosthetics and makeup for visceral reality'
      };
    }
    return 'Traditional horror without body focus';
  }

  private static getCosmicHorror(subgenre: string): any {
    if (subgenre.includes('cosmic')) {
      return {
        humanInsignificance: 'Revealing meaninglessness of human existence in vast cosmos',
        incomprehensibleEntities: 'Ancient beings whose nature shatters human understanding',
        forbiddenKnowledge: 'Truth too terrible for human mind to comprehend',
        scaleEmphasis: 'Vastness of environment contrasted with human smallness'
      };
    }
    return 'Traditional horror without cosmic elements';
  }

  private static getSlasherHorror(subgenre: string): any {
    if (subgenre.includes('slasher')) {
      return {
        huntMechanics: 'Systematic stalking and elimination of victims',
        formulaicStructure: 'Rigid narrative patterns for tension and release cycles',
        finalGirlTrope: 'Lone female survivor confronting killer in final act',
        isolationIngredients: 'Cut-off settings with absent or incompetent authority'
      };
    }
    return 'Traditional horror without slasher elements';
  }

  private static getFolkHorror(subgenre: string): any {
    if (subgenre.includes('folk')) {
      return {
        traditionTerror: 'Ancient belief systems clashing with modern rationality',
        isolatedCommunity: 'Rural settings with hostile, incomprehensible worldviews',
        landscapeCharacter: 'Natural environment imbued with malevolent historical power',
        paganismFocus: 'Human adherence to ancient rituals as horror source'
      };
    }
    return 'Traditional horror without folk elements';
  }

  private static getPredatorEye(style: string): any {
    const styles: { [key: string]: any } = {
      'classic': {
        powerDynamics: 'High/low angle shots establishing vulnerability/dominance',
        staticParanoia: 'Locked frames inviting audience frame scanning',
        povPerspective: 'Camera as psychological prosthesis for killer/victim viewpoint',
        traditionalMovement: 'Dolly and crane shots for omniscient stalking perspective'
      },
      'modern': {
        handheldChaos: 'Shaky cam mimicking physiological stress and panic',
        dutchDisorientation: 'Tilted horizons signaling psychological imbalance',
        trackingStalking: 'Smooth camera movement creating predatory following',
        digitalStabilization: 'Precise movement control for maximum psychological impact'
      }
    };
    return styles[style] || styles['classic'];
  }

  private static getCraftingNightmares(strategy: string): any {
    const strategies: { [key: string]: any } = {
      'practical': {
        tangibleEffects: 'Physical prosthetics and animatronics for reality grounding',
        actorInteraction: 'Direct performer engagement with practical creatures',
        craftTradition: 'Lifecasting, sculpting, molding, and application techniques',
        viscералAuthenticity: 'Handcrafted quality enhancing audience awe and revulsion'
      },
      'digital': {
        impossibleReality: 'CGI enabling physics-defying transformations and creatures',
        safetyAdvantage: 'Risk-free simulation of dangerous events',
        uncanyValleyRisk: 'Potential artificiality breaking immersion',
        scalabilityBenefit: 'Cost-effective large-scale effects and environments'
      },
      'hybrid': {
        integratedApproach: 'Practical base enhanced with digital augmentation',
        bestOfBoth: 'Tangible reality foundation with impossible enhancement',
        seamlessBlending: 'Invisible transition between practical and digital elements',
        modernStandard: 'Contemporary industry approach maximizing both strengths'
      }
    };
    return strategies[strategy] || strategies['hybrid'];
  }

  private static getColorOfFear(intensity: string): any {
    return {
      redViolence: 'Primal blood association for danger and rage signaling',
      coolDeath: 'Blue/green tones for supernatural cold and emotional detachment',
      desaturatedBleakness: 'Washed-out palette for decay and lifelessness mood',
      subvertingWarmth: 'Safe colors in horrific context for cognitive dissonance',
      gradingManipulation: 'Post-production hue and saturation control for mood',
      intensityLevel: `${intensity} color psychology application for maximum impact`
    };
  }

  private static getDigitalGhost(relevance: string): any {
    if (relevance.includes('digital') || relevance.includes('contemporary')) {
      return {
        socialMediaTerror: 'Influencer horror exploring online fame mechanics',
        livestreamHorror: 'Real-time found footage with audience complicity',
        unreliablePlatform: 'Technology corruption vs unreliable narrator evolution',
        parasocialNightmares: 'One-sided creator-follower intimacy turned sinister'
      };
    }
    return 'Traditional horror without digital elements';
  }

  private static getHorrorAsMetaphor(themes: string[]): any {
    return {
      monsterAsIdeology: 'Physical embodiment of harmful social systems',
      socialCommentary: 'Real-world issue allegory through supernatural framework',
      groundedRealism: 'Plausible horror scenarios for intellectual resonance',
      collectiveAnxiety: 'Contemporary fear identification and narrative amplification',
      thematicEmbodiment: `${themes.join(', ')} themes manifested through monstrous representation`
    };
  }

  private static getGlobalScream(sensitivity: string): any {
    if (sensitivity.includes('international') || sensitivity.includes('cultural')) {
      return {
        jHorrorTradition: 'Japanese psychological dread, technology curses, vengeful spirits',
        frenchExtremity: 'Transgressive visceral approach with nihilistic narratives',
        southeastAsianFolk: 'Local folklore monsters and mythology integration',
        respectfulIntegration: 'Cultural authenticity without appropriation or stereotypes'
      };
    }
    return 'Western horror tradition focus';
  }

  private static getNewCanvases(scope: string): any {
    if (scope.includes('streaming') || scope.includes('interactive')) {
      return {
        streamingOptimization: 'Binge-model episodic structure and technical delivery',
        mobileVertical: 'Bite-sized terror for mobile device consumption',
        vrImmersive: 'Virtual reality total presence and multi-sensory engagement',
        interactiveBranching: 'Participant agency affecting horror narrative outcomes'
      };
    }
    return 'Traditional cinematic horror presentation';
  }

  private static getPsychologicalApproach(approach: string): string {
    const approaches: { [key: string]: string } = {
      'neurobiological': 'Dual-Pathway Fear Engineering',
      'evolutionary': 'Primal Fear Activation',
      'existential': 'Death Anxiety Confrontation',
      'cultural': 'Social Mirror Terror'
    };
    return approaches[approach] || 'Integrated Psychological Framework';
  }

  private static getAtmosphericConstruction(intensity: string): string {
    const constructions: { [key: string]: string } = {
      'subtle': 'Subliminal Dread Building',
      'moderate': 'Balanced Tension Architecture',
      'intense': 'Maximum Atmospheric Assault',
      'overwhelming': 'Sensory Overload Terror'
    };
    return constructions[intensity] || 'Calibrated Atmospheric Design';
  }

  private static getSubgenreSpecialization(subgenre: string): string {
    const specializations: { [key: string]: string } = {
      'psychological': 'Mind-Based Terror Mastery',
      'supernatural': 'Otherworldly Threat Expertise',
      'body': 'Flesh Horror Specialization',
      'cosmic': 'Existential Insignificance Focus',
      'slasher': 'Predation Fear Engineering',
      'folk': 'Traditional Terror Revival'
    };
    return specializations[subgenre] || 'Multi-Subgenre Integration';
  }

  private static getVisualExecution(style: string): string {
    const executions: { [key: string]: string } = {
      'classic': 'Traditional Cinematographic Language',
      'modern': 'Contemporary Visual Innovation',
      'experimental': 'Avant-Garde Terror Visualization',
      'hybrid': 'Blended Classical-Modern Approach'
    };
    return executions[style] || 'Adaptive Visual Strategy';
  }

  private static getContemporaryAdaptation(relevance: string): string {
    const adaptations: { [key: string]: string } = {
      'digital': 'Social Media Horror Integration',
      'social': 'Cultural Commentary Framework',
      'global': 'International Tradition Synthesis',
      'interactive': 'Immersive Experience Design'
    };
    return adaptations[relevance] || 'Modern Horror Evolution';
  }

  private static getNeurobiologicalTechniques(approach: string): string[] {
    return [
      `Master ${approach} fear pathway targeting for optimal terror response`,
      "Engineer amygdala hijacking through low-road stimulus design",
      "Build sustained cortical dread via high-road atmospheric construction",
      "Apply fear conditioning principles for narrative-specific triggers"
    ];
  }

  private static getAtmosphericMethods(intensity: string): string[] {
    return [
      `Construct ${intensity} environmental psychology for maximum unease`,
      "Design psychoacoustic soundscapes targeting primal fear responses",
      "Apply chiaroscuro lighting techniques for shadow-based terror",
      "Engineer temporal pacing for optimal physiological manipulation"
    ];
  }

  private static getSubgenreFrameworks(subgenre: string): string[] {
    return [
      `Master ${subgenre} horror conventions and psychological mechanisms`,
      "Apply subgenre-specific atmospheric and narrative techniques",
      "Integrate traditional elements with contemporary innovations",
      "Balance formula adherence with creative subversion"
    ];
  }

  private static getCinematographicApproaches(style: string): string[] {
    return [
      `Apply ${style} cinematographic language for visual terror`,
      "Master camera psychology for predator/victim perspective control",
      "Integrate practical and digital effects for maximum impact",
      "Design color palettes targeting specific emotional responses"
    ];
  }

  private static getModernInnovations(relevance: string): string[] {
    return [
      `Integrate ${relevance} contemporary horror innovations`,
      "Adapt traditional fear principles to modern anxieties",
      "Optimize for streaming and interactive consumption models",
      "Incorporate global horror traditions respectfully and effectively"
    ];
  }
}
 